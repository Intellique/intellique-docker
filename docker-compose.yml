version: "2.0"

services:
        api:
                depends_on:
                        - db
                hostname: api
                image: intellique/api:testing
                volumes:
                        - data-admin:/var/lib/storiqone-backend
                        - data-vol:/var/www/nextcloud/data

        daemon:
                depends_on:
                        - db
                hostname: daemon
                image: intellique/daemon:testing
                volumes:
                        - data-vol:/var/www/nextcloud/data

        db:
                hostname: db
                image: intellique/database:testing

        nextcloud:
                depends_on:
                        - db
                image: intellique/nextcloud:testing
                volumes:
                        - data-admin:/var/lib/storiqone-backend:ro
                        - data-vol:/var/www/nextcloud/data

        proxy:
                depends_on:
                        - api
                        - nextcloud
                        - webui
                image: intellique/haproxy:testing
                ports:
                        - "80:80"

        webui:
                depends_on:
                        - api
                hostname: webui
                image: intellique/webui:testing

volumes:
        data-admin:
        data-vol:
